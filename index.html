<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Teste Browser</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            box-sizing: border-box;
        }

        #container {
            display: flex;
            height: 90vh;
        }

        textarea,
        iframe {
            width: 100vh;
            height: 100vh;
            border: none;
            resize: none;
            padding: 10px;
            font-size: 16px;
        }

        textarea {
            border-right: 1px solid #ccc;
        }
    </style>
</head>

<body>
    <div id="container">
        <iframe id="meuIframe" src=""></iframe>
    </div>

    <script type="module" async>
        import { DAV55, DANFe, DANFCe } from './src/index.ts'; // descomente se o arquivo existir

        function onChangeTexto(event) {
            const textarea = event.target;

            DANFe({ xml: `<NFe xmlns="http://www.portalfiscal.inf.br/nfe"> <infNFe Id="NFe51250247506306000188550000000002561000002577" versao="4.00"> <ide> <cUF>51</cUF> <cNF>00000257</cNF> <natOp>VENDA</natOp> <mod>55</mod> <serie>0</serie> <nNF>256</nNF> <dhEmi>2025-02-27T13:20:52-04:00</dhEmi> <tpNF>1</tpNF> <idDest>1</idDest> <cMunFG>5106257</cMunFG> <tpImp>1</tpImp> <tpEmis>1</tpEmis> <cDV>7</cDV> <tpAmb>1</tpAmb> <finNFe>1</finNFe> <indFinal>1</indFinal> <indPres>1</indPres> <indIntermed>0</indIntermed> <procEmi>0</procEmi> <verProc>4.13</verProc> </ide> <emit> <CNPJ>47506306000188</CNPJ> <xNome>47.506.306 KALMON VALADAO TAVARES</xNome> <xFant>47.506.306 KALMON VALADAO TAVARES</xFant> <enderEmit> <xLgr>AV PARA</xLgr> <nro>138</nro> <xBairro>UNI√ÉO</xBairro> <cMun>5106257</cMun> <xMun>Nova Xavantina</xMun> <UF>MT</UF> <CEP>78690000</CEP> <cPais>1058</cPais> <xPais>BRASIL</xPais> <fone>66981352912</fone> </enderEmit> <IE>139551956</IE> <CRT>1</CRT> </emit> <dest> <CNPJ>15024045000173</CNPJ> <xNome>PREFEITURA MUNICIPAL DE NOVA XAVANTINA</xNome> <enderDest> <xLgr>AVENIDA EXPEDICAO RONCADOR XINGU</xLgr> <nro>249</nro> <xCpl>SETOR XAVANTINA</xCpl> <xBairro>CENTRO</xBairro> <cMun>5106257</cMun> <xMun>Nova Xavantina</xMun> <UF>MT</UF> <CEP>78690000</CEP> <cPais>1058</cPais> <xPais>BRASIL</xPais> </enderDest> <indIEDest>2</indIEDest> </dest> <det nItem="1"> <prod> <cProd>388</cProd> <cEAN>SEM GTIN</cEAN> <xProd>PLACA LOGICA BROTHER DCP-L5602DN DCP5502 D000VT001 ORIGINAL</xProd> <NCM>84439931</NCM> <CFOP>5102</CFOP> <uCom>UNID</uCom> <qCom>1.0000</qCom> <vUnCom>1300.0000000000</vUnCom> <vProd>1300.00</vProd> <cEANTrib>SEM GTIN</cEANTrib> <uTrib>UNID</uTrib> <qTrib>1.0000</qTrib> <vUnTrib>1300.0000000000</vUnTrib> <indTot>1</indTot> </prod> <imposto> <ICMS> <ICMSSN102> <orig>0</orig> <CSOSN>400</CSOSN> </ICMSSN102> </ICMS> <PIS> <PISOutr> <CST>49</CST> <qBCProd>0.0000</qBCProd> <vAliqProd>0.0000</vAliqProd> <vPIS>0.00</vPIS> </PISOutr> </PIS> <COFINS> <COFINSOutr> <CST>49</CST> <qBCProd>0.0000</qBCProd> <vAliqProd>0.0000</vAliqProd> <vCOFINS>0.00</vCOFINS> </COFINSOutr> </COFINS> </imposto> </det> <total> <ICMSTot> <vBC>0.00</vBC> <vICMS>0.00</vICMS> <vICMSDeson>0.00</vICMSDeson> <vFCP>0.00</vFCP> <vBCST>0.00</vBCST> <vST>0.00</vST> <vFCPST>0.00</vFCPST> <vFCPSTRet>0.00</vFCPSTRet> <vProd>1300.00</vProd> <vFrete>0.00</vFrete> <vSeg>0.00</vSeg> <vDesc>0.00</vDesc> <vII>0.00</vII> <vIPI>0.00</vIPI> <vIPIDevol>0.00</vIPIDevol> <vPIS>0.00</vPIS> <vCOFINS>0.00</vCOFINS> <vOutro>0.00</vOutro> <vNF>1300.00</vNF> </ICMSTot> </total> <transp> <modFrete>9</modFrete> </transp> <pag> <detPag> <indPag>0</indPag> <tPag>18</tPag> <vPag>1300.00</vPag> </detPag> <vTroco>0.00</vTroco> </pag> <infRespTec> <CNPJ>47506306000188</CNPJ> <xContato>Guara Dev</xContato> <email>admin@guaradev.com</email> <fone>5566999638922</fone> </infRespTec> </infNFe> </NFe>`, imgDemo: "http://localhost:5173/demo1.png", logo: "http://localhost:5173/logo.jpg" }).then(res => {
                console.log(res)
                const blob = new Blob([res], { type: 'application/pdf' }); // <- usa res direto
                const url = URL.createObjectURL(blob);
                document.querySelector("#meuIframe").src = url;
            });
        }

        //const textarea = document.getElementById("meuTextarea");
        //textarea.addEventListener("input", onChangeTexto);

        DAV55({ xml: await fetch("/DANFE.json").then(res => res.text()), logo: "http://localhost:5173/logo.jpg", orcamento: true }).then(res => {
            console.log(res)
            const blob = new Blob([res], { type: 'application/pdf' }); // <- usa res direto
            const url = URL.createObjectURL(blob);
            document.querySelector("#meuIframe").src = url;
        });


    </script>
</body>

</html>